The ZeroMQ WebSockets Transport Protocol (ZWTP) is a transport layer protocol for exchanging UTF8 string messages between two peers over a WebSockets. This document describes ZWTP/1.0.

* Name: rfc.zeromq.org/spec:39/ZWTP
* Editor: Doron Somech <somdoron@gmail.com>
* Contributors: 

++ Goals

The ZeroMQ WebSockets Transport Protocol (ZWTP) is a transport layer protocol for exchanging UTF8 string messages between two peers over a WebSockets. This document describes ZWTP/1.0.

++ Implementation

This document doesn't describe the WebSockets protocol (RFC6455) and only defines the handshake and messaging over it.
Any impelemtation of this protocol also must implement the RFC6455.

WebSockets is message oriented, so this protocol doesn't define how messages are structured on the wire.
WebSockets also has framing concept, however the concept is different than ZeroMQ framing and the WebSockets framing is not used by ZWTP 1.0. 
ZWTP defines its own framing.

+++ Handshaking

+++ Framing

+++ Resource Sharing

+++ Socket Compatibility

The implementation SHOULD enforce that an incoming connection has a valid socket type, depending on the socket type of the socket receiving the connection:

* PAIR accepts connections from PAIR.
* PUB accepts connections from SUB.
* SUB accepts connections from PUB.
* REQ accepts connections from REP or ROUTER.
* REP accepts connections from REQ or DEALER.
* DEALER accepts connections from REP, DEALER, or ROUTER.
* ROUTER accepts connections from REQ, DEALER, or ROUTER.
* PULL accepts connections from PUSH.
* PUSH accepts connections from PULL.

Any other socket combinations SHOULD be handled by silently disconnecting the other peer and possibly logging the error for debugging purposes.

+++ Publish-Subscribe

XPUB and XSUB sockets are implemented at the protocol level as PUB and SUB sockets. 
That is, XPUB and XSUB are API constructs only. A SUB socket sends a subscription message as one UTF8 character '1' followed by the subscription body, and unsubscription messages as one UTF8 character '0' followed by the subscription body.

Note: ZMTP defines one byte x00 and x01 as unsubscribe and subscribe, also the Sub and Pub socket type of zeromq only recognize x00 and x01 as unsubscribe and subcriber.
Therefore if ZWTP implemented inside ZeroMQ for interoperability before sending the unsubscribe or subscribe on the wire the implementation should replace the one byte with one UTF8 character and vice versa when reading from the wire.
